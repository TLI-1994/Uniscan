rules:
  - id: unity.reflection.using-namespace
    message: Uses System.Reflection (review in context)
    languages: [csharp]
    severity: INFO
    pattern: using System.Reflection;

  - id: unity.autorun.editor-hooks
    message: Editor/run hooks that auto-execute code
    languages: [csharp]
    severity: WARNING
    pattern-either:
      # Classes
      - pattern: |
          [InitializeOnLoad]
          class $CLASS { ... }
      - pattern: |
          [InitializeOnLoad]
          public class $CLASS { ... }
      - pattern: |
          [InitializeOnLoad]
          internal class $CLASS { ... }
      - pattern: |
          [InitializeOnLoad]
          public static class $CLASS { ... }
      - pattern: |
          [InitializeOnLoad]
          static class $CLASS { ... }
      - pattern: |
          [InitializeOnLoad]
          public partial class $CLASS { ... }
      - pattern: |
          [InitializeOnLoad]
          partial class $CLASS { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoad]
          class $CLASS { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoad]
          public class $CLASS { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoad]
          public static class $CLASS { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoad]
          static class $CLASS { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoad]
          public partial class $CLASS { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoad]
          partial class $CLASS { ... }
      - pattern: |
          [ExecuteAlways]
          class $CLASS { ... }
      - pattern: |
          [ExecuteAlways]
          public class $CLASS { ... }
      - pattern: |
          [ExecuteAlways]
          public static class $CLASS { ... }
      - pattern: |
          [ExecuteAlways]
          static class $CLASS { ... }
      - pattern: |
          [ExecuteAlways]
          public partial class $CLASS { ... }
      - pattern: |
          [ExecuteAlways]
          partial class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteAlways]
          class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteAlways]
          public class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteAlways]
          public static class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteAlways]
          static class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteAlways]
          public partial class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteAlways]
          partial class $CLASS { ... }
      - pattern: |
          [ExecuteInEditMode]
          class $CLASS { ... }
      - pattern: |
          [ExecuteInEditMode]
          public class $CLASS { ... }
      - pattern: |
          [ExecuteInEditMode]
          public static class $CLASS { ... }
      - pattern: |
          [ExecuteInEditMode]
          static class $CLASS { ... }
      - pattern: |
          [ExecuteInEditMode]
          public partial class $CLASS { ... }
      - pattern: |
          [ExecuteInEditMode]
          partial class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteInEditMode]
          class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteInEditMode]
          public class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteInEditMode]
          public static class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteInEditMode]
          static class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteInEditMode]
          public partial class $CLASS { ... }
      - pattern: |
          [UnityEditor.ExecuteInEditMode]
          partial class $CLASS { ... }
      # Methods
      - pattern: |
          [InitializeOnLoadMethod]
          static void $METHOD(...) { ... }
      - pattern: |
          [InitializeOnLoadMethod]
          public static void $METHOD(...) { ... }
      - pattern: |
          [InitializeOnLoadMethod]
          private static void $METHOD(...) { ... }
      - pattern: |
          [InitializeOnLoadMethod(...)]
          static void $METHOD(...) { ... }
      - pattern: |
          [InitializeOnLoadMethod(...)]
          public static void $METHOD(...) { ... }
      - pattern: |
          [InitializeOnLoadMethod(...)]
          private static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoadMethod]
          static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoadMethod]
          public static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoadMethod]
          private static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoadMethod(...)]
          static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoadMethod(...)]
          public static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.InitializeOnLoadMethod(...)]
          private static void $METHOD(...) { ... }
      - pattern: |
          [RuntimeInitializeOnLoadMethod]
          static void $METHOD(...) { ... }
      - pattern: |
          [RuntimeInitializeOnLoadMethod]
          public static void $METHOD(...) { ... }
      - pattern: |
          [RuntimeInitializeOnLoadMethod]
          private static void $METHOD(...) { ... }
      - pattern: |
          [RuntimeInitializeOnLoadMethod(...)]
          static void $METHOD(...) { ... }
      - pattern: |
          [RuntimeInitializeOnLoadMethod(...)]
          public static void $METHOD(...) { ... }
      - pattern: |
          [RuntimeInitializeOnLoadMethod(...)]
          private static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.RuntimeInitializeOnLoadMethod]
          static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.RuntimeInitializeOnLoadMethod]
          public static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.RuntimeInitializeOnLoadMethod]
          private static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.RuntimeInitializeOnLoadMethod(...)]
          static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.RuntimeInitializeOnLoadMethod(...)]
          public static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.RuntimeInitializeOnLoadMethod(...)]
          private static void $METHOD(...) { ... }
      - pattern: |
          [DidReloadScripts]
          static void $METHOD(...) { ... }
      - pattern: |
          [DidReloadScripts]
          public static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.DidReloadScripts]
          static void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.DidReloadScripts]
          public static void $METHOD(...) { ... }
      - pattern: |
          [PreProcessBuild]
          void $METHOD(...) { ... }
      - pattern: |
          [PreProcessBuild]
          public void $METHOD(...) { ... }
      - pattern: |
          [PreProcessBuild(...)]
          void $METHOD(...) { ... }
      - pattern: |
          [PreProcessBuild(...)]
          public void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PreProcessBuild]
          void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PreProcessBuild]
          public void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PreProcessBuild(...)]
          void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PreProcessBuild(...)]
          public void $METHOD(...) { ... }
      - pattern: |
          [PostProcessBuild]
          void $METHOD(...) { ... }
      - pattern: |
          [PostProcessBuild]
          public void $METHOD(...) { ... }
      - pattern: |
          [PostProcessBuild(...)]
          void $METHOD(...) { ... }
      - pattern: |
          [PostProcessBuild(...)]
          public void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PostProcessBuild]
          void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PostProcessBuild]
          public void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PostProcessBuild(...)]
          void $METHOD(...) { ... }
      - pattern: |
          [UnityEditor.PostProcessBuild(...)]
          public void $METHOD(...) { ... }

  - id: unity.proc.exec.process-start
    message: External process execution
    languages: [csharp]
    severity: ERROR
    pattern-either:
      - pattern: System.Diagnostics.Process.Start(...)
      - pattern: new System.Diagnostics.ProcessStartInfo(...)

  - id: unity.net.literal-url
    message: Hard-coded URL in source (review origin domain)
    languages: [csharp]
    severity: INFO
    pattern-regex: '"https?://[^"\n]+' 

  - id: unity.net.discord-webhook
    message: Discord webhook found (common exfil target)
    languages: [csharp]
    severity: ERROR
    pattern-regex: 'https://(?:canary\.|ptb\.)?discord\.com/api/webhooks/'

  - id: unity.deserialize.binaryformatter
    message: Insecure BinaryFormatter deserialization
    languages: [csharp]
    severity: ERROR
    pattern-either:
      - pattern: new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter(...)
      - pattern: new BinaryFormatter(...)

  - id: unity.crypto.weak-algos
    message: Weak/legacy crypto (DES/RC2/3DES)
    languages: [csharp]
    severity: WARNING
    pattern-either:
      - pattern: System.Security.Cryptography.DES.Create(...)
      - pattern: System.Security.Cryptography.RC2.Create(...)
      - pattern: System.Security.Cryptography.TripleDES.Create(...)

  - id: unity.net.insecure-http
    message: Plain HTTP (insecure) URL used
    languages: [csharp]
    severity: WARNING
    pattern-regex: '"http://[^"\n]+'
